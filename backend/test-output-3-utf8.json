
> backend@0.0.1 test
> jest --json

{"numFailedTestSuites":1,"numFailedTests":4,"numPassedTestSuites":17,"numPassedTests":64,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":18,"numTotalTests":68,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1772046963675,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["CurrencyService"],"duration":22,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046965857,"status":"passed","title":"should be defined"},{"ancestorTitles":["CurrencyService","getRates"],"duration":11,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyService getRates should return rates with EUR as base currency","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1772046965880,"status":"passed","title":"should return rates with EUR as base currency"},{"ancestorTitles":["CurrencyService","getRates"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyService getRates should return rates from cache on second call","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046965892,"status":"passed","title":"should return rates from cache on second call"},{"ancestorTitles":["CurrencyService","getRates"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyService getRates should include common currencies","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1772046965898,"status":"passed","title":"should include common currencies"},{"ancestorTitles":["CurrencyService","clearCache"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyService clearCache should clear the cache","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046965902,"status":"passed","title":"should clear the cache"}],"endTime":1772046965915,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\currency\\currency.service.spec.ts","startTime":1772046964519,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["CurrencyController"],"duration":23,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046965985,"status":"passed","title":"should be defined"},{"ancestorTitles":["CurrencyController","getRates"],"duration":11,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyController getRates should return exchange rates","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1772046966008,"status":"passed","title":"should return exchange rates"},{"ancestorTitles":["CurrencyController","getRates"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyController getRates should return rates with EUR as base","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966019,"status":"passed","title":"should return rates with EUR as base"},{"ancestorTitles":["CurrencyController","clearCache"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"CurrencyController clearCache should clear the cache","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966025,"status":"passed","title":"should clear the cache"}],"endTime":1772046966030,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\currency\\currency.controller.spec.ts","startTime":1772046964498,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["GroupAdminGuard"],"duration":25,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966395,"status":"passed","title":"should be defined"},{"ancestorTitles":["GroupAdminGuard"],"duration":11,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should allow SUPER_ADMIN without checking group membership","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966421,"status":"passed","title":"should allow SUPER_ADMIN without checking group membership"},{"ancestorTitles":["GroupAdminGuard"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should allow GROUP ADMIN","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966433,"status":"passed","title":"should allow GROUP ADMIN"},{"ancestorTitles":["GroupAdminGuard"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should deny GROUP MEMBER (not admin)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966440,"status":"passed","title":"should deny GROUP MEMBER (not admin)"},{"ancestorTitles":["GroupAdminGuard"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should deny non-member","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966455,"status":"passed","title":"should deny non-member"},{"ancestorTitles":["GroupAdminGuard"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should throw if groupId is missing","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966460,"status":"passed","title":"should throw if groupId is missing"},{"ancestorTitles":["GroupAdminGuard"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupAdminGuard should throw if user is not authenticated","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966466,"status":"passed","title":"should throw if user is not authenticated"}],"endTime":1772046966471,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\auth\\guards\\group-admin.guard.spec.ts","startTime":1772046964488,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["GroupsService"],"duration":25,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupsService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966463,"status":"passed","title":"should be defined"},{"ancestorTitles":["GroupsService","update"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupsService update should update group country","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1772046966489,"status":"passed","title":"should update group country"}],"endTime":1772046966499,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\groups\\groups.service.spec.ts","startTime":1772046964493,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["GroupsController"],"duration":24,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupsController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966473,"status":"passed","title":"should be defined"},{"ancestorTitles":["GroupsController","update"],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GroupsController update should call service.update with correct params","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966497,"status":"passed","title":"should call service.update with correct params"}],"endTime":1772046966508,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\groups\\groups.controller.spec.ts","startTime":1772046964488,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["AdminService"],"duration":27,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"AdminService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966465,"status":"passed","title":"should be defined"},{"ancestorTitles":["AdminService","forceLogout"],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"AdminService forceLogout should increment token version correctly when null","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966493,"status":"passed","title":"should increment token version correctly when null"},{"ancestorTitles":["AdminService","forceLogout"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"AdminService forceLogout should increment token version correctly when 0","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966502,"status":"passed","title":"should increment token version correctly when 0"},{"ancestorTitles":["AdminService","forceLogout"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"AdminService forceLogout should increment token version correctly when 1","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966507,"status":"passed","title":"should increment token version correctly when 1"}],"endTime":1772046966515,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\admin\\admin.service.spec.ts","startTime":1772046964508,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["WeatherController"],"duration":23,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966525,"status":"passed","title":"should be defined"},{"ancestorTitles":["WeatherController","getWeather"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherController getWeather should return weather data for valid inputs","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966549,"status":"passed","title":"should return weather data for valid inputs"},{"ancestorTitles":["WeatherController","getWeather"],"duration":13,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherController getWeather should throw BadRequestException if lat is missing","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966556,"status":"passed","title":"should throw BadRequestException if lat is missing"},{"ancestorTitles":["WeatherController","getWeather"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherController getWeather should throw BadRequestException if invalid lat/lon provided","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966569,"status":"passed","title":"should throw BadRequestException if invalid lat/lon provided"}],"endTime":1772046966574,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\weather\\weather.controller.spec.ts","startTime":1772046965942,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["PreferencesService"],"duration":20,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"PreferencesService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966591,"status":"passed","title":"should be defined"}],"endTime":1772046966613,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\preferences\\preferences.service.spec.ts","startTime":1772046964489,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["WeatherService"],"duration":18,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966574,"status":"passed","title":"should be defined"},{"ancestorTitles":["WeatherService","getWeatherForDate"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherService getWeatherForDate should call fetchForecast for dates within 14 days","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1772046966592,"status":"passed","title":"should call fetchForecast for dates within 14 days"},{"ancestorTitles":["WeatherService","getWeatherForDate"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherService getWeatherForDate should call fetchHistorical for dates > 14 days in future with 1 year offset","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1772046966600,"status":"passed","title":"should call fetchHistorical for dates > 14 days in future with 1 year offset"},{"ancestorTitles":["WeatherService","getWeatherForDate"],"duration":20,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"WeatherService getWeatherForDate should throw HttpException on error","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966604,"status":"passed","title":"should throw HttpException on error"}],"endTime":1772046966626,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\weather\\weather.service.spec.ts","startTime":1772046966053,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["AppController","root"],"duration":20,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"AppController root should return \"Hello World!\"","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966731,"status":"passed","title":"should return \"Hello World!\""}],"endTime":1772046966753,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\app.controller.spec.ts","startTime":1772046964495,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["PreferencesController"],"duration":22,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"PreferencesController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966728,"status":"passed","title":"should be defined"}],"endTime":1772046966752,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\preferences\\preferences.controller.spec.ts","startTime":1772046964469,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["UsersService"],"duration":21,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966775,"status":"passed","title":"should be defined"},{"ancestorTitles":["UsersService","uploadAvatar"],"duration":4,"failing":false,"failureDetails":[{}],"failureMessages":["TypeError: this.usersRepository.findOneBy is not a function\n    at UsersService.findOne (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.ts:40:37)\n    at UsersService.uploadAvatar (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.ts:26:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at Object.<anonymous> (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.spec.ts:69:28)"],"fullName":"UsersService uploadAvatar should upload file and update user avatar url","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1772046966796,"status":"failed","title":"should upload file and update user avatar url"},{"ancestorTitles":["UsersService","uploadAvatar"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersService uploadAvatar should throw error if upload fails","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966808,"status":"passed","title":"should throw error if upload fails"},{"ancestorTitles":["UsersService","remove"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersService remove should delete a user for id != 1","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966813,"status":"passed","title":"should delete a user for id != 1"},{"ancestorTitles":["UsersService","remove"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersService remove should block deleting the primary super admin account (id: 1)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966817,"status":"passed","title":"should block deleting the primary super admin account (id: 1)"},{"ancestorTitles":["UsersService","updatePassword"],"duration":15,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).rejects.toThrow(expected)\n\nExpected substring: \"Utilisateur introuvable.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:104:34)","pass":false},"message":"expect(received).rejects.toThrow(expected)\n\nExpected substring: \"Utilisateur introuvable.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:104:34)"}],"failureMessages":["Error: expect(received).rejects.toThrow(expected)\n\nExpected substring: \"Utilisateur introuvable.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:104:34)\n    at Object.toThrow (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\expect\\build\\index.js:2155:20)\n    at Object.<anonymous> (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.spec.ts:104:81)\n    at Promise.finally.completed (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"],"fullName":"UsersService updatePassword should throw if user not found","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1772046966821,"status":"failed","title":"should throw if user not found"},{"ancestorTitles":["UsersService","updatePassword"],"duration":4,"failing":false,"failureDetails":[{"matcherResult":{"message":"expect(received).rejects.toThrow(expected)\n\nExpected substring: \"L'ancien mot de passe est incorrect.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:111:34)","pass":false},"message":"expect(received).rejects.toThrow(expected)\n\nExpected substring: \"L'ancien mot de passe est incorrect.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:111:34)"}],"failureMessages":["Error: expect(received).rejects.toThrow(expected)\n\nExpected substring: \"L'ancien mot de passe est incorrect.\"\nReceived message:   \"this.usersRepository.findOneBy is not a function\"\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (src/users/users.service.ts:40:37)\n      at UsersService.updatePassword (src/users/users.service.ts:81:33)\n      at Object.<anonymous> (src/users/users.service.spec.ts:111:34)\n    at Object.toThrow (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\expect\\build\\index.js:2155:20)\n    at Object.<anonymous> (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.spec.ts:111:80)\n    at Promise.finally.completed (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"],"fullName":"UsersService updatePassword should throw if old password does not match","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1772046966837,"status":"failed","title":"should throw if old password does not match"},{"ancestorTitles":["UsersService","updatePassword"],"duration":1,"failing":false,"failureDetails":[{}],"failureMessages":["TypeError: this.usersRepository.findOneBy is not a function\n    at UsersService.findOne (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.ts:40:37)\n    at UsersService.updatePassword (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.ts:81:33)\n    at Object.<anonymous> (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.spec.ts:120:27)\n    at Promise.finally.completed (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1557:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1497:10)\n    at _callCircusTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1007:40)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at _runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:947:3)\n    at C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:849:7\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:862:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at _runTestsForDescribeBlock (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:857:11)\n    at run (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:761:3)\n    at runAndTransformResultsToJestFormat (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\jestAdapterInit.js:1918:21)\n    at jestAdapter (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-circus\\build\\runner.js:101:19)\n    at runTestInternal (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"],"fullName":"UsersService updatePassword should update password and hash the new one","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1772046966842,"status":"failed","title":"should update password and hash the new one"}],"endTime":1772046966848,"message":"  ÔùÅ UsersService ÔÇ║ uploadAvatar ÔÇ║ should upload file and update user avatar url\n\n    TypeError: this.usersRepository.findOneBy is not a function\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (users/users.service.ts:40:37)\n      at UsersService.uploadAvatar (users/users.service.ts:26:40)\n      at Object.<anonymous> (users/users.service.spec.ts:69:28)\n\n  ÔùÅ UsersService ÔÇ║ updatePassword ÔÇ║ should throw if user not found\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"Utilisateur introuvable.\"\n    Received message:   \"this.usersRepository.findOneBy is not a function\"\n\n        \u001b[0m \u001b[90m 38 |\u001b[39m\n         \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n         \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 41 |\u001b[39m     }\n         \u001b[90m 42 |\u001b[39m\n         \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (users/users.service.ts:40:37)\n      at UsersService.updatePassword (users/users.service.ts:81:33)\n      at Object.<anonymous> (users/users.service.spec.ts:104:34)\n      at Object.toThrow (../node_modules/expect/build/index.js:2155:20)\n      at Object.<anonymous> (users/users.service.spec.ts:104:81)\n\n  ÔùÅ UsersService ÔÇ║ updatePassword ÔÇ║ should throw if old password does not match\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"L'ancien mot de passe est incorrect.\"\n    Received message:   \"this.usersRepository.findOneBy is not a function\"\n\n        \u001b[0m \u001b[90m 38 |\u001b[39m\n         \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n        \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n         \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n         \u001b[90m 41 |\u001b[39m     }\n         \u001b[90m 42 |\u001b[39m\n         \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (users/users.service.ts:40:37)\n      at UsersService.updatePassword (users/users.service.ts:81:33)\n      at Object.<anonymous> (users/users.service.spec.ts:111:34)\n      at Object.toThrow (../node_modules/expect/build/index.js:2155:20)\n      at Object.<anonymous> (users/users.service.spec.ts:111:80)\n\n  ÔùÅ UsersService ÔÇ║ updatePassword ÔÇ║ should update password and hash the new one\n\n    TypeError: this.usersRepository.findOneBy is not a function\n\n    \u001b[0m \u001b[90m 38 |\u001b[39m\n     \u001b[90m 39 |\u001b[39m     \u001b[36masync\u001b[39m findOne(id\u001b[33m:\u001b[39m number)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 40 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[36mthis\u001b[39m\u001b[33m.\u001b[39musersRepository\u001b[33m.\u001b[39mfindOneBy({ id })\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 41 |\u001b[39m     }\n     \u001b[90m 42 |\u001b[39m\n     \u001b[90m 43 |\u001b[39m     \u001b[36masync\u001b[39m findByUsername(username\u001b[33m:\u001b[39m string)\u001b[33m:\u001b[39m \u001b[33mPromise\u001b[39m\u001b[33m<\u001b[39m\u001b[33mUser\u001b[39m \u001b[33m|\u001b[39m \u001b[36mnull\u001b[39m\u001b[33m>\u001b[39m {\u001b[0m\n\n      at UsersService.findOne (users/users.service.ts:40:37)\n      at UsersService.updatePassword (users/users.service.ts:81:33)\n      at Object.<anonymous> (users/users.service.spec.ts:120:27)\n","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.service.spec.ts","startTime":1772046964492,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["GeocodingService"],"duration":13,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GeocodingService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966893,"status":"passed","title":"should be defined"},{"ancestorTitles":["GeocodingService","getCoordinates"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GeocodingService getCoordinates should append context to query","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966906,"status":"passed","title":"should append context to query"},{"ancestorTitles":["GeocodingService","getCoordinates"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GeocodingService getCoordinates should use countrycodes=jp for Nominatim when context is Japan","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966910,"status":"passed","title":"should use countrycodes=jp for Nominatim when context is Japan"},{"ancestorTitles":["GeocodingService","getCoordinates"],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"GeocodingService getCoordinates should NOT use countrycodes for other contexts","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966914,"status":"passed","title":"should NOT use countrycodes for other contexts"}],"endTime":1772046966917,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\suggestions\\geocoding.service.spec.ts","startTime":1772046966500,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["ItineraryService"],"duration":16,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966850,"status":"passed","title":"should be defined"},{"ancestorTitles":["ItineraryService","findAll"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService findAll should return itineraries filtered by userId when no groupId is provided","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966867,"status":"passed","title":"should return itineraries filtered by userId when no groupId is provided"},{"ancestorTitles":["ItineraryService","findAll"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService findAll should return itineraries filtered by userId OR groupId when groupId is provided","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966874,"status":"passed","title":"should return itineraries filtered by userId OR groupId when groupId is provided"},{"ancestorTitles":["ItineraryService","generate"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService generate should exclude TRANSPORT and AUTRE from clustering","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1772046966878,"status":"passed","title":"should exclude TRANSPORT and AUTRE from clustering"},{"ancestorTitles":["ItineraryService","getBudgetSummary"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService getBudgetSummary should calculate daily totals and grand total correctly","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"startAt":1772046966883,"status":"passed","title":"should calculate daily totals and grand total correctly"},{"ancestorTitles":["ItineraryService","getBudgetSummary"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService getBudgetSummary should return 0 if no prices are set","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966891,"status":"passed","title":"should return 0 if no prices are set"},{"ancestorTitles":["ItineraryService","getBudgetSummary"],"duration":27,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryService getBudgetSummary should throw NotFoundException if itinerary not found","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966895,"status":"passed","title":"should throw NotFoundException if itinerary not found"}],"endTime":1772046966923,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\itinerary\\itinerary.service.spec.ts","startTime":1772046964479,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["SuggestionsService"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966856,"status":"passed","title":"should be defined"},{"ancestorTitles":["SuggestionsService","update"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService update should allow setting price to 0","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966871,"status":"passed","title":"should allow setting price to 0"},{"ancestorTitles":["SuggestionsService","create"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService create should set isGlobal to true by default","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966877,"status":"passed","title":"should set isGlobal to true by default"},{"ancestorTitles":["SuggestionsService","create"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService create should link to a default country if no groupId is provided","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966882,"status":"passed","title":"should link to a default country if no groupId is provided"},{"ancestorTitles":["SuggestionsService","create"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService create should auto-link to user's only group if groupId is missing","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1772046966896,"status":"passed","title":"should auto-link to user's only group if groupId is missing"},{"ancestorTitles":["SuggestionsService","remove"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService remove should allow Super Admin to delete others suggestion","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1772046966899,"status":"passed","title":"should allow Super Admin to delete others suggestion"},{"ancestorTitles":["SuggestionsService","remove"],"duration":16,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsService remove should deny non-owner/non-admin","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046966905,"status":"passed","title":"should deny non-owner/non-admin"}],"endTime":1772046966922,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\suggestions\\suggestions.service.spec.ts","startTime":1772046964494,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["ItineraryController"],"duration":13,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967071,"status":"passed","title":"should be defined"},{"ancestorTitles":["ItineraryController","findAll"],"duration":10,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryController findAll should call service.findAll with userId and no groupId if not provided","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967085,"status":"passed","title":"should call service.findAll with userId and no groupId if not provided"},{"ancestorTitles":["ItineraryController","findAll"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"ItineraryController findAll should call service.findAll with userId and groupId if provided","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967095,"status":"passed","title":"should call service.findAll with userId and groupId if provided"}],"endTime":1772046967101,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\itinerary\\itinerary.controller.spec.ts","startTime":1772046964490,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["UsersController"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967082,"status":"passed","title":"should be defined"},{"ancestorTitles":["UsersController","updatePassword"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersController updatePassword should call usersService.updatePassword with correct args","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967096,"status":"passed","title":"should call usersService.updatePassword with correct args"},{"ancestorTitles":["UsersController","count"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"UsersController count should return count","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967102,"status":"passed","title":"should return count"}],"endTime":1772046967106,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\users\\users.controller.spec.ts","startTime":1772046964485,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["SuggestionsController"],"duration":14,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"SuggestionsController should be defined","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1772046967163,"status":"passed","title":"should be defined"}],"endTime":1772046967178,"message":"","name":"C:\\Users\\yonid\\.gemini\\antigravity\\scratch\\japan-trip-planner\\backend\\src\\suggestions\\suggestions.controller.spec.ts","startTime":1772046964480,"status":"passed","summary":""}],"wasInterrupted":false}
